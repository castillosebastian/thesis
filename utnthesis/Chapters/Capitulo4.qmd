# Experimentos realizados y sus resultados {#sec-Capitulo4}

En este capítulo se presentan los experimentos realizados en el marco de la investigación, cuyo objetivo principal fue evaluar la efectividad de la combinación de Algoritmos Genéticos (AGs) y Autoencoders Variacionales (AVs) en la selección de características en contextos de escasez de datos. Para ello, se diseñaron y ejecutaron experimentos utilizando cuatro conjuntos de datos distintos: *leukemia*, *gisette*, *madelon* y *gcm*, cada uno representando diferentes desafíos en términos de dimensionalidad y características de los datos.

El enfoque experimental adoptado fue comparativo, enfrentando la capacidad de los AGs en la selección de características utilizando los datos originales frente a la misma tarea utilizando datos aumentados generados por AVs. Los parámetros de los AGs fueron mantenidos constantes entre los grupos de experimentos con y sin aumento, permitiendo una evaluación directa del impacto de la aumentación de datos.

La metodología seguida para cada experimento se describe a continuación

### Leukemia

#### Metodología

El conjunto de datos *leukemia* es conocido por su alta dimensionalidad relativa al número de muestras, lo que lo convierte en un candidato ideal para evaluar la capacidad de los AVs para generar datos sintéticos que puedan mejorar el desempeño de los AGs en la selección de características. En este experimento, el objetivo fue realizar una comparación directa entre el rendimiento de los AGs sobre los datos originales y sobre un conjunto de datos aumentado con muestras generadas por un AV.

**Configuración Experimental:**
- **Mutación:** PROB_MUT = 1/IND_SIZE (0.0001)
- **Probabilidad de cruce:** PX = 0.75
- **Cromosoma activo:** p = 0.1
- **Número máximo de generaciones:** GMAX = 20

Se realizaron dos conjuntos de experimentos:
1. **Datos originales:** Se trabajó directamente con las muestras disponibles en el conjunto *leukemia*.
2. **Datos aumentados:** Se generaron 100 muestras sintéticas adicionales mediante un AV entrenado específicamente para este conjunto de datos.

El razonamiento detrás de esta configuración fue mantener la complejidad del problema mientras se introduce una cantidad moderada de datos sintéticos para evaluar su impacto sin alterar significativamente la naturaleza del problema original.

Inicialmente, los AGs fueron aplicados tanto al conjunto de datos original como al aumentado, utilizando la misma configuración de hiperparámetros. El objetivo era observar si la aumentación de datos podría proporcionar ventajas en términos de precisión en la clasificación, número de características seleccionadas y velocidad de convergencia.

Se realizaron múltiples pruebas exploratorias para investigar distintas configuraciones del cromosoma activo y el número de muestras generadas por el AV, buscando determinar el impacto de estas variables sobre el desempeño del AG. Por ejemplo, se redujo el tamaño del cromosoma activo a p = 0.01 y luego a p = 0.005 para observar cómo afectaba esto a la selección de características.

#### Resultados

En los experimentos realizados sobre el conjunto de datos leukemia, los resultados mostraron una ligera mejora en la precisión (accuracy) cuando se utilizó la aumentación de datos mediante AVs en comparación con el uso de datos originales. Específicamente, la precisión media del grupo de datos aumentados fue de 0.992, con una desviación estándar de 0.011, mientras que la precisión media del grupo de datos originales fue de 0.989, con una desviación estándar de 0.016.

![Precisión en Leukemia](boxplot_leukemia_combined.png)

Interpretación: La diferencia en la precisión es mínima y estadísticamente no significativa (p-value: 0.995), lo que sugiere que en este conjunto de datos, donde los modelos ya alcanzan una precisión cercana al 100%, la aumentación de datos no produce una mejora sustancial en la precisión. Sin embargo, es notable que la estabilidad de los resultados es ligeramente mejor en los datos aumentados, reflejada en una menor dispersión de la precisión.

Selección de Características
El análisis del número de características seleccionadas promedio (pob_ngenes_avg) indicó que tanto en los datos originales como en los aumentados, el número de características seleccionadas fue similar, con medias de 259.167 y 258.909, respectivamente. No se observó una diferencia significativa en la eficiencia de la selección de características entre ambos grupos.

Interpretación: La similitud en la cantidad de características seleccionadas sugiere que la estructura de correlación entre las características en el conjunto de datos leukemia permite al AG encontrar soluciones similares, independientemente de la aumentación de datos. Esto puede deberse a la alta correlación entre las características del conjunto de datos, lo que facilita la tarea del AG, incluso sin la necesidad de datos adicionales.

### Gisette

#### Metodología

El conjunto de datos *gisette* es un problema de clasificación binaria con alta dimensionalidad y un número equilibrado de muestras en ambas clases. Este conjunto de datos fue seleccionado para evaluar cómo la aumentación de datos afecta la selección de características en un contexto donde el espacio de características es grande, pero la relación señal-ruido es moderada.

**Configuración Experimental:**
- **Mutación:** PROB_MUT = 1/IND_SIZE (0.0002)
- **Probabilidad de cruce:** PX = 0.75
- **Cromosoma activo:** p = 0.1
- **Número máximo de generaciones:** GMAX = 30

Se generaron 600 muestras sintéticas adicionales utilizando un AV. Los experimentos se dividieron en dos grupos:
1. **Datos originales:** Aplicación directa del AG sobre el conjunto *gisette* sin modificaciones.
2. **Datos aumentados:** Se añadieron las 600 muestras sintéticas al conjunto original para observar el impacto en la selección de características.

En este experimento, se prestó especial atención a la reducción del espacio de búsqueda mediante la disminución del tamaño del cromosoma activo y la observación de cómo esta reducción, combinada con la aumentación de datos, afectaba la eficiencia del AG. Se investigó también el impacto de generar un número mucho mayor de muestras sintéticas (6000), reduciendo agresivamente el tamaño del cromosoma para evaluar si el modelo podría identificar características relevantes en un espacio de búsqueda más limitado.

#### Resultados

En el caso del conjunto de datos gisette, los resultados fueron similares a los observados en leukemia. La precisión media fue ligeramente superior en los experimentos con datos aumentados (0.960) en comparación con los datos originales (0.959), pero nuevamente, la diferencia no fue estadísticamente significativa (p-value: 0.066).

Interpretación: La falta de una mejora significativa en la precisión sugiere que la aumentación de datos mediante AVs tiene un impacto limitado en conjuntos de datos donde los modelos ya alcanzan una alta precisión. Sin embargo, es importante destacar que la estabilidad de la selección de características mejoró con la aumentación, como se refleja en la menor desviación estándar y el rango intercuartil (IQR) en la precisión.

Selección de Características
El análisis de pob_ngenes_avg reveló una diferencia más notable en la eficiencia de la selección de características. En los experimentos con datos aumentados, el número promedio de características seleccionadas fue menor (424.231) en comparación con los datos originales (436.667). Esto indica una mayor eficiencia en la selección de características al utilizar datos sintéticos generados por AVs.

Interpretación: La reducción en el número de características seleccionadas en los datos aumentados sugiere que la aumentación ayuda al AG a concentrarse en un subconjunto más relevante de características. Esta observación es importante, ya que una selección más eficiente de características puede mejorar la interpretabilidad y reducir la complejidad del modelo, sin comprometer la precisión.

### Madelon

#### Metodología

El conjunto de datos *madelon* es un caso especial donde solo cinco características son relevantes, mientras que otras quince son combinaciones lineales de estas, y el resto es ruido. Este conjunto de datos fue utilizado para evaluar si la combinación de AVs y AGs podría mejorar la identificación de las características relevantes en un entorno donde la señal está oculta entre una gran cantidad de ruido.

**Configuración Experimental:**
- **Mutación:** PROB_MUT = 1/IND_SIZE (0.002)
- **Probabilidad de cruce:** PX = 0.75
- **Cromosoma activo:** p = 0.1
- **Número máximo de generaciones:** GMAX = 30

Se generaron 2000 muestras sintéticas para incrementar el número de observaciones disponibles y evaluar si esto mejoraba la capacidad del AG para encontrar las características relevantes.

- **Datos originales:** Se trabajó directamente con las muestras disponibles en el conjunto *madelon*.
- **Datos aumentados:** Se generaron 2000 muestras sintéticas adicionales mediante un AV entrenado específicamente para este conjunto de datos.

Se realizaron experimentos comparativos entre los datos originales y los aumentados, manteniendo constantes los parámetros del AG. El objetivo fue observar si el AV podía generar datos sintéticos que preservaran la estructura subyacente de las características relevantes, permitiendo al AG identificar correctamente las cinco características esenciales. Se monitoreó especialmente la precisión en la clasificación y la estabilidad de la selección de características a lo largo de las generaciones.

#### Resultados

El conjunto de datos madelon mostró resultados significativamente diferentes en comparación con leukemia y gisette. La precisión media en los experimentos con datos aumentados fue de 0.828, lo que representa un aumento del 10.4% en comparación con la precisión de los datos originales (0.750). Esta diferencia fue estadísticamente significativa (p-value: 0.000), lo que indica que la aumentación de datos tuvo un impacto positivo en el desempeño del AG.

Interpretación: Estos resultados demuestran que la aumentación de datos puede ser especialmente efectiva en conjuntos de datos con características complejas y un alto nivel de ruido, como es el caso de madelon. La generación de muestras sintéticas permitió al AG identificar mejor las características relevantes, lo que se tradujo en una mejora significativa en la precisión del modelo.

Selección de Características
El análisis de pob_ngenes_avg reveló que, en promedio, el número de características seleccionadas fue menor en los experimentos con datos aumentados (29.033) en comparación con los datos originales (35.796). Este resultado indica una mayor eficiencia en la selección de características cuando se utiliza aumentación de datos.

Interpretación: La capacidad del AG para seleccionar un subconjunto más pequeño de características relevantes en el grupo de datos aumentados refuerza la hipótesis de que la aumentación de datos puede mejorar tanto la precisión como la eficiencia de la selección de características, especialmente en conjuntos de datos con una estructura compleja de características.


### Experimento 4: GCM

#### Metodología 

El conjunto de datos *gcm* representa un desafío aún mayor debido a la alta dimensionalidad y el bajo número de muestras. Este conjunto fue seleccionado para evaluar la capacidad del AV de generar datos sintéticos que ayuden a los AGs a seleccionar características en un escenario donde los datos originales son extremadamente limitados.

**Configuración Experimental:**
- **Mutación:** PROB_MUT = 1/IND_SIZE (0.00006)
- **Probabilidad de cruce:** PX = 0.75
- **Cromosoma activo:** p = 0.1
- **Número máximo de generaciones:** GMAX = 20

Se realizaron múltiples experimentos exploratorios con diferentes tamaños de muestras sintéticas (desde 200 hasta 1400) y diferentes configuraciones del cromosoma activo, buscando identificar las condiciones óptimas para la selección de características en este conjunto de datos.

Se exploraron varias configuraciones, incluyendo la mezcla de datos originales y sintéticos durante el entrenamiento del AG, así como la evaluación del modelo en una partición original del conjunto de datos. Se prestó especial atención a la calidad de las muestras generadas por el AV y su impacto en la selección de características, así como a la posibilidad de que los AGs estuvieran sobreajustándose a los datos sintéticos, en detrimento de su capacidad de generalización.

#### Resultados

El conjunto de datos gcm, que presenta un desafío significativo debido a su alta dimensionalidad y bajo número de muestras, mostró resultados mixtos. La precisión media fue ligeramente superior en los experimentos con datos aumentados (0.517) en comparación con los datos originales (0.467). Sin embargo, la diferencia no fue estadísticamente significativa (p-value: 0.355).

Interpretación: La falta de una mejora significativa en la precisión sugiere que, en el caso de gcm, la calidad de los datos sintéticos generados por el AV no fue suficiente para superar las limitaciones impuestas por la alta dimensionalidad y la complejidad del conjunto de datos. Es posible que el AV no haya sido capaz de capturar adecuadamente la distribución de probabilidad original, lo que limitó la capacidad del AG para generalizar a partir de los datos sintéticos.

Selección de Características
El análisis de pob_ngenes_avg mostró que el número promedio de características seleccionadas fue mayor en los datos aumentados (378.477) en comparación con los datos originales (305.160). Esto sugiere que la selección de características fue menos eficiente en los experimentos con datos aumentados.

Interpretación: La mayor cantidad de características seleccionadas en los experimentos con datos aumentados puede indicar que el AG tuvo dificultades para identificar un subconjunto relevante de características cuando se le proporcionaron datos sintéticos que no representaban adecuadamente la estructura original del conjunto de datos. Este resultado destaca la importancia de la calidad de los datos sintéticos en la eficacia de la selección de características.

Ajustes y Resultados Posteriores
Para abordar las limitaciones observadas, se realizaron ajustes en la metodología, como la integración de pesos de clase en la función de pérdida personalizada del AV y la inclusión de un muestreador aleatorio ponderado en el cargador de datos. Estos ajustes, junto con una subselección inicial de características, mejoraron significativamente los resultados en una serie posterior de experimentos, alcanzando una precisión balanceada superior al 0.65 en algunos casos.

Interpretación: Estos resultados sugieren que, si bien la aumentación de datos mediante AVs puede enfrentar desafíos significativos en conjuntos de datos complejos como gcm, es posible mejorar la calidad de los datos sintéticos mediante ajustes en la arquitectura del AV y en la metodología de selección de características. La combinación de AVs y AGs en un flujo de trabajo iterativo y refinado demostró ser una estrategia prometedora para mejorar la precisión y la eficiencia en la selección de características.



